{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "UsageExtraction",
  "type": "object",
  "required": [
    "documentId",
    "documentType",
    "customerName",
    "locations",
    "commodity",
    "unit",
    "totalUsage",
    "usageHistory"
  ],
  "properties": {
    "documentId": {
      "type": "string",
      "description": "Unique identifier or file name"
    },
    "documentType": {
      "type": "string",
      "enum": [
        "sampleBill",
        "contract"
      ],
      "description": "Source document type"
    },
    "statementDate": {
      "type": "string",
      "format": "date"
    },
    "contractStart": {
      "type": "string",
      "format": "date",
      "nullable": true
    },
    "contractEnd": {
      "type": "string",
      "format": "date",
      "nullable": true
    },
    "customerName": {
      "type": "string"
    },
    "commodity": {
      "type": "string",
      "enum": [
        "electricity",
        "natural_gas"
      ]
    },
    "unit": {
      "type": "string",
      "enum": [
        "kWh",
        "therms",
        "MMBTU",
        "CCF"
      ]
    },
    "deliveryCharge": {
      "type": "number"
    },
    "supplyCharge": {
      "type": "number"
    },
    "taxCharge": {
      "type": "number"
    },
    "totalUsage": {
      "type": "number"
    },
    "deliveryRate": {
      "type": "number"
    },
    "supplyRate": {
      "type": "number"
    },
    "taxRate": {
      "type": "number"
    },
    "usageHistory": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "month",
          "usage"
        ],
        "properties": {
          "month": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}$"
          },
          "usage": {
            "type": "number"
          }
        }
      }
    },
    "locations": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": [
          "accountNumber",
          "serviceAddress",
          "commodity",
          "unit",
          "usageHistory"
        ],
        "properties": {
          "accountNumber": {
            "type": "string"
          },
          "serviceAddress": {
            "type": "string"
          },
          "meterNumber": {
            "type": "string",
            "nullable": true
          },
          "commodity": {
            "type": "string",
            "enum": [
              "electricity",
              "natural_gas"
            ]
          },
          "rateClass": {
            "type": "string",
            "nullable": true
          },
          "unit": {
            "type": "string",
            "enum": [
              "kWh",
              "therms",
              "MMBTU",
              "CCF"
            ]
          },
          "usageHistory": {
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "month",
                "usage"
              ],
              "properties": {
                "month": {
                  "type": "string",
                  "pattern": "^\\d{4}-\\d{2}$"
                },
                "usage": {
                  "type": "number"
                }
              }
            }
          },
          "currentUsage": {
            "type": "number"
          },
          "deliveryCharge": {
            "type": "number"
          },
          "supplyCharge": {
            "type": "number"
          },
          "taxCharge": {
            "type": "number"
          },
          "deliveryRate": {
            "type": "number"
          },
          "supplyRate": {
            "type": "number"
          },
          "taxRate": {
            "type": "number"
          },
          "notes": {
            "type": "object",
            "properties": {
              "addressesIncluded": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "accountsIncluded": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "aggregationNotice": {
                "type": "string"
              },
              "estimationMethod": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "reportType": {
      "type": "string",
      "enum": [
        "savings",
        "budget"
      ]
    }
  }
}